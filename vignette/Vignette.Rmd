---
title: The Chinese Restaurant Process
author: Jack Potrykus & Ruben Abbou
date: Winter 2021
output: html_document
bibliography: bib.bib
---

## Motivation

The Chinese Restaurant Process (CRP) is a Bayesian nonparametric method which has uses in clustering microarray gene expression data. Many of the successful techniques which have proven to work for this type of data (such as Gibbs sampling, Markov chain Monte Carlo or hidden Markov models) rely on previous knowledge about the data such as the number of clusters. This can be problematic as microarray data may contain important fluctuation and we may not always know the number of clusters we aim to separate. The CRP provides an alternative method which does not require prior knowledge on the data, and assumes an infinite number of latent clusters.

## Method

### Overview

A Chinese restaurant is composed of an infinite number of tables. Suppose that customers enter the restaurant. Let $\alpha \in \mathbb{R}^+$. The table assignment is done by the CRP using the following algorithm:

- The first customer is assigned to the first table
- The second customer will choose between the first (occupied) table with probability $\frac{1}{1+\alpha}$ and the second table with probability $\frac{\alpha}{1+\alpha}$.
- Each following $n$th customer chooses their table assignment with probability proportional to the number of previous customers sitting at each table (for  occupied tables), and with probability $\frac{\alpha}{n-1+\alpha}$ for the next unoccupied table.

$\alpha$ is called the concentration parameter. As $\alpha$ increases, the CRP will produce more occupied tables and fewer customers per table.

<center>

![CRP_figure](../assets/CRP_figure.png)
</center>

### Formulation

Let $\mathbf{c}_{n}$ be the table assigned to the $n$th customer, $m_k$ the number of customers sitting at table $k$ and $K_+$ the number of occupied tables.

$$P\left(c_{n}=k \mid \mathbf{c}_{1: n-1}\right) \propto\left\{\begin{array}{ll}
\frac{m_{k}}{n-1+\alpha} & \text { if } k \le K_+ \\
\frac{\alpha}{n-1+\alpha} & \text { if } k \text { is the next unoccupied table}
\end{array}\right.$$

The CRP is an exchangeable process, as $p(c)$ does not depend on the order in which customers arrive. The proof can be found in @gershman2011tutorial.

### Mixture Models

We can use the CRP to cluster data into an infinite number of dimensions.

## Examples

In @10.1093/bioinformatics/btl284, the authors propose a method based on the CRP to cluster microarray gene expression data. The algorithm consists in a Gibbs sampler initialized with a random number of clusters. They then iterate over each data point (here, genes) and reassign them to the cluster in which they are most likely to belong, or if it is more likely to be in a new cluster alone. The algorithm is run until convergence.

The Chinese restaurant process is not only able to improve the accuracy of the Gibbs sampler, but also facilitates the recognition and clustering of genes that display complex correlation relationships such as time-shifted and/or inverted with others. They obtained rapid convergence of the Gibbs sampler. The following figure displays the cluster assignments for the Yeast galactose dataset.

<center>

![yeast_figure](../assets/yeast_clustering.png)
</center>



## Exercises

1. Show that the expected number of tables is $\mathbb{E}\left[K_{+}\right]=\alpha \log N$, for $\alpha < \frac{N}{\log N}$.
2. Prove the exchangeability property of the Chinese Random Process.

#### Sources
